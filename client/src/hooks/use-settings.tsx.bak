import React, { createContext, ReactNode, useCallback, useContext, useEffect, useState } from "react";
import { useQuery, useMutation, useQueryClient } from "@tanstack/react-query";
import { useAuth } from "./use-auth";
import { apiRequest } from "../lib/api";
import { useToast } from "./use-toast";
import { toast } from "./use-toast";
import { translations as allTranslations } from '../lib/translations';

/**
 * Configurazione tema e lingua dell'applicazione
 */

// Type definitions
export type Theme = "light" | "dark" | "system";
export type Language = "en" | "it" | "es" | "fr" | "de" | "zh" | "ja" | "pt" | "ru";

// Translation interface
export interface Translation {
  settings: string;
  settingsDescription: string;
  updates: string;
  version: string;
  theme: string;
  language: string;
  system: string;
  light: string;
  dark: string;
  english: string;
  italian: string;
  spanish: string;
  french: string;
  german: string;
  chinese: string;
  japanese: string;
  portuguese: string;
  russian: string;
  games: string;
  streaming: string;
  banking: string;
  shopping: string;
  social: string;
  mail: string;
  various: string;
  connection: string;
  browserai: string;
  music: string;
  gaming: string;
  productivity: string;
  education: string;
  technology: string;
  entertainment: string;
  financial: string;
  orderBy: string;
  favorites: string;
  noFavorites: string;
  addToFavorites: string;
  removeFromFavorites: string;
  favoriteAdded: string;
  favoriteRemoved: string;
  login: string;
  register: string;
  logout: string;
  admin: string;
  loggingIn: string;
  loggingOut: string;
  creatingAccount: string;
  loginDescription: string;
  registerDescription: string;
  emailPlaceholder: string;
  passwordPlaceholder: string;
  usernamePlaceholder: string;
  confirmPassword: string;
  confirmPasswordPlaceholder: string;
  passwordMismatch: string;
  accountTitle: string;
  username: string;
  email: string;
  role: string;
  registeredAt: string;
  serverStatus: string;
  operational: string;
  degraded: string;
  down: string;
  unknown: string;
  error: string;
  success: string;
  partialOutage: string;
  dashboard: string;
  dashboardDescription: string;
  heroDescription: string;
  currentStatus: string;
  categories: string;
  lastUpdated: string;
  lastCheck: string;
  responseTime: string;
  checkingNow: string;
  checkNow: string;
  viewDetails: string;
  backToDashboard: string;
  expand: string;
  collapse: string;
  uptime30d: string;
  lastOutage: string;
  avgResponse: string;
  uptimeHistory: string;
  recentIncidents: string;
  noHistoryAvailable: string;
  noIncidentsReported: string;
  noRecentOutages: string;
  overall: string;
  close: string;
  search: string;
  searchServices: string;
  selectTheme: string;
  selectLanguage: string;
  links: string;
  to: string;
  toPresent: string;
  siteUpdates: string;
  footerText: string;
  infoAndContacts: string;
  terms: string;
  privacy: string;
  termsTitle: string;
  termsContent: string;
  privacyContent: string;
  viewFullHistory: string;
  subscribeToUpdates: string;
  serviceDetails: string;
}

// Context type definition
export interface SettingsContextType {
  theme: Theme;
  language: Language;
  t: (key: keyof Translation) => string;
  setTheme: (theme: Theme) => void;
  setLanguage: (lang: Language) => void;
  favorites: string[];
  isFavorite: (id: string) => boolean;
  addFavorite: (id: string) => void;
  removeFavorite: (id: string) => void;
}

// Context creation
const SettingsContext = createContext<SettingsContextType | undefined>(undefined);

// Hook personalizzato per utilizzare le impostazioni
export const useSettings = () => {
  const context = useContext(SettingsContext);
  if (!context) {
    throw new Error('useSettings must be used within a SettingsProvider');
  }
  return context;
};

// Provider component
export const SettingsProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [theme, setTheme] = useState<Theme>(() => {
    const saved = localStorage.getItem('theme');
    return (saved as Theme) || 'system';
  });

  const [language, setLanguage] = useState<Language>(() => {
    const saved = localStorage.getItem('language');
    return (saved as Language) || 'en';
  });

  const [favorites, setFavorites] = useState<string[]>(() => {
    const saved = localStorage.getItem('favorites');
    return saved ? JSON.parse(saved) : [];
  });

  // Effetti per salvare le impostazioni
  useEffect(() => {
    localStorage.setItem('theme', theme);
  }, [theme]);

  useEffect(() => {
    localStorage.setItem('language', language);
  }, [language]);

  useEffect(() => {
    localStorage.setItem('favorites', JSON.stringify(favorites));
  }, [favorites]);

  // Funzione per ottenere le traduzioni
  const t = useCallback((key: keyof Translation): string => {
    return allTranslations[language][key] || allTranslations.en[key] || key;
  }, [language]);

  // Gestione dei preferiti
  const isFavorite = useCallback((id: string) => favorites.includes(id), [favorites]);

  const addFavorite = useCallback((id: string) => {
    setFavorites(prev => Array.from(new Set([...prev, id])));
  }, []);

  const removeFavorite = useCallback((id: string) => {
    setFavorites(prev => prev.filter(favId => favId !== id));
  }, []);

  const value: SettingsContextType = {
    theme,
    language,
    t,
    setTheme,
    setLanguage,
    favorites,
    isFavorite,
    addFavorite,
    removeFavorite
  };

  return (
    <SettingsContext.Provider value={value}>
      {children}
    </SettingsContext.Provider>
  );
};
export interface Translation {
  // Base translations
  settings: string;
  settingsDescription: string;
  updates: string;
  version: string;

  // Themes and languages
  theme: string;
  language: string;
  system: string;
  light: string;
  dark: string;
  english: string;
  italian: string;
  spanish: string;
  french: string;
  german: string;
  chinese: string;
  japanese: string;
  portuguese: string;
  russian: string;

  // Categories
  games: string;
  streaming: string;
  banking: string;
  shopping: string;
  social: string;
  mail: string;
  various: string;
  connection: string;
  browserai: string;
  music: string;
  gaming: string;
  productivity: string;
  education: string;
  technology: string;
  entertainment: string;
  financial: string;
  orderBy: string;

  // Favorites
  favorites: string;
  noFavorites: string;
  addToFavorites: string;
  removeFromFavorites: string;
  favoriteAdded: string;
  favoriteRemoved: string;

  // Authentication
  login: string;
  register: string;
  logout: string;
  admin: string;
  loggingIn: string;
  loggingOut: string;
  creatingAccount: string;
  loginDescription: string;
  registerDescription: string;

  // Form placeholders
  emailPlaceholder: string;
  passwordPlaceholder: string;
  usernamePlaceholder: string;
  confirmPassword: string;
  confirmPasswordPlaceholder: string;
  passwordMismatch: string;

  // Account
  accountTitle: string;
  username: string;
  email: string;
  role: string;
  registeredAt: string;

  // Status and operations
  serverStatus: string;
  operational: string;
  degraded: string;
  down: string;
  unknown: string;
  error: string;
  success: string;
  partialOutage: string;

  // Dashboard elements
  dashboard: string;
  dashboardDescription: string;
  heroDescription: string;
  currentStatus: string;
  categories: string;
  lastUpdated: string;
  lastCheck: string;
  responseTime: string;
  checkingNow: string;
  checkNow: string;
  viewDetails: string;
  backToDashboard: string;
  expand: string;
  collapse: string;

  // Statistics and history
  uptime30d: string;
  lastOutage: string;
  avgResponse: string;
  uptimeHistory: string;
  recentIncidents: string;
  noHistoryAvailable: string;
  noIncidentsReported: string;
  noRecentOutages: string;
  overall: string;

  // UI elements
  close: string;
  search: string;
  searchServices: string;
  selectTheme: string;
  selectLanguage: string;
  links: string;
  to: string;
  toPresent: string;
  siteUpdates: string;
  footerText: string;
  infoAndContacts: string;

  // Legal
  terms: string;
  privacy: string;
  termsTitle: string;
  termsContent: string;
  privacyContent: string;

  // Additional features
  viewFullHistory: string;
  subscribeToUpdates: string;
  serviceDetails: string;
}

export const translations: Record<Language, Translation> = {
  en: {
    settings: "Settings",
    settingsDescription: "Customize your experience by changing theme and language",
    updates: "Updates",
    version: "Version",
    theme: "Theme",
    language: "Language",
    system: "System",
    light: "Light",
    dark: "Dark",
    english: "English",
    italian: "Italian",
    spanish: "Spanish",
    french: "French",
    german: "German",
    chinese: "Chinese",
    japanese: "Japanese",
    portuguese: "Portuguese",
    russian: "Russian",
    games: "Games",
    streaming: "Streaming",
    banking: "Banking",
    shopping: "Shopping",
    social: "Social",
    mail: "Mail",
    various: "Various",
    connection: "Connection",
    browserai: "Browser & AI",
    music: "Music",
    gaming: "Gaming",
    productivity: "Productivity",
    education: "Education",
    technology: "Technology",
    entertainment: "Entertainment",
    financial: "Financial",
    orderBy: "Order by",
    favorites: "Favorites",
    noFavorites: "No favorites added",
    addToFavorites: "Add to favorites",
    removeFromFavorites: "Remove from favorites",
    favoriteAdded: "Added to favorites",
    favoriteRemoved: "Removed from favorites",
    login: "Login",
    register: "Register",
    logout: "Logout",
    admin: "Admin",
    loggingIn: "Logging in...",
    loggingOut: "Logging out...",
    creatingAccount: "Creating account...",
    loginDescription: "Login to manage your settings and favorites",
    registerDescription: "Create an account to save your preferences",
    emailPlaceholder: "Email address",
    passwordPlaceholder: "Password",
    usernamePlaceholder: "Username",
    confirmPassword: "Confirm password",
    confirmPasswordPlaceholder: "Re-enter password",
    passwordMismatch: "Passwords do not match",
    accountTitle: "Account information",
    username: "Username",
    email: "Email",
    role: "Role",
    registeredAt: "Registered at",
    serverStatus: "Server Status",
    operational: "Operational",
    degraded: "Degraded",
    down: "Down",
    unknown: "Unknown",
    error: "Error",
    success: "Success",
    partialOutage: "Partial outage",
    dashboard: "Dashboard",
    dashboardDescription: "Monitor all your favorite services",
    heroDescription: "Real-time status for your essential services",
    currentStatus: "Current Status",
    categories: "Categories",
    lastUpdated: "Last updated",
    lastCheck: "Last check",
    responseTime: "Response time",
    checkingNow: "Checking now...",
    checkNow: "Check now",
    viewDetails: "View details",
    backToDashboard: "Back to dashboard",
    expand: "Expand",
    collapse: "Collapse",
    uptime30d: "Uptime (30d)",
    lastOutage: "Last outage",
    avgResponse: "Avg. response time",
    uptimeHistory: "Uptime history",
    recentIncidents: "Recent incidents",
    noHistoryAvailable: "No history available",
    noIncidentsReported: "No incidents reported",
    noRecentOutages: "No recent outages",
    overall: "Overall",
    close: "Close",
    search: "Search",
    searchServices: "Search services...",
    selectTheme: "Select theme",
    selectLanguage: "Select language",
    links: "Links",
    to: "to",
    toPresent: "to present",
    siteUpdates: "Site Updates",
    footerText: "Made with ❤️",
    infoAndContacts: "Info & Contacts",
    terms: "Terms",
    privacy: "Privacy",
    termsTitle: "Terms of Service",
    termsContent: "Our Terms of Service explain your rights and responsibilities when using our services.",
    privacyContent: "Our Privacy Policy describes how we handle your personal data and protect your privacy.",
    viewFullHistory: "View full history",
    subscribeToUpdates: "Subscribe to updates",
    serviceDetails: "Service details"
  },
  it: {
    settings: "Impostazioni",
    settingsDescription: "Personalizza la tua esperienza cambiando tema e lingua",
    updates: "Aggiornamenti",
    version: "Versione",
    theme: "Tema",
    language: "Lingua",
    system: "Sistema",
    light: "Chiaro",
    dark: "Scuro",
    english: "Inglese",
    italian: "Italiano",
    spanish: "Spagnolo",
    french: "Francese",
    german: "Tedesco",
    chinese: "Cinese",
    japanese: "Giapponese",
    portuguese: "Portoghese",
    russian: "Russo",
    games: "Giochi",
    streaming: "Streaming",
    banking: "Banche",
    shopping: "Shopping",
    social: "Social",
    mail: "Posta",
    various: "Varie",
    connection: "Connessione",
    browserai: "Browser e IA",
    music: "Musica",
    gaming: "Gaming",
    productivity: "Produttività",
    education: "Educazione",
    technology: "Tecnologia",
    entertainment: "Intrattenimento",
    financial: "Finanza",
    orderBy: "Ordina per",
    favorites: "Preferiti",
    noFavorites: "Nessun preferito aggiunto",
    addToFavorites: "Aggiungi ai preferiti",
    removeFromFavorites: "Rimuovi dai preferiti",
    favoriteAdded: "Aggiunto ai preferiti",
    favoriteRemoved: "Rimosso dai preferiti",
    login: "Accedi",
    register: "Registrati",
    logout: "Esci",
    admin: "Admin",
    loggingIn: "Accesso in corso...",
    loggingOut: "Uscita in corso...",
    creatingAccount: "Creazione account...",
    loginDescription: "Accedi per gestire le tue impostazioni e i preferiti",
    registerDescription: "Crea un account per salvare le tue preferenze",
    emailPlaceholder: "Indirizzo email",
    passwordPlaceholder: "Password",
    usernamePlaceholder: "Nome utente",
    confirmPassword: "Conferma password",
    confirmPasswordPlaceholder: "Reinserisci la password",
    passwordMismatch: "Le password non coincidono",
    accountTitle: "Informazioni account",
    username: "Nome utente",
    email: "Email",
    role: "Ruolo",
    registeredAt: "Registrato il",
    serverStatus: "Stato Server",
    operational: "Operativo",
    degraded: "Degradato",
    down: "Non disponibile",
    unknown: "Sconosciuto",
    error: "Errore",
    success: "Successo",
    partialOutage: "Interruzione parziale",
    dashboard: "Dashboard",
    dashboardDescription: "Monitora tutti i tuoi servizi preferiti",
    heroDescription: "Stato in tempo reale per i tuoi servizi essenziali",
    currentStatus: "Stato attuale",
    categories: "Categorie",
    lastUpdated: "Ultimo aggiornamento",
    lastCheck: "Ultimo controllo",
    responseTime: "Tempo di risposta",
    checkingNow: "Controllo in corso...",
    checkNow: "Controlla ora",
    viewDetails: "Vedi dettagli",
    backToDashboard: "Torna alla dashboard",
    expand: "Espandi",
    collapse: "Comprimi",
    uptime30d: "Disponibilità (30g)",
    lastOutage: "Ultima interruzione",
    avgResponse: "Tempo di risposta medio",
    uptimeHistory: "Storico disponibilità",
    recentIncidents: "Incidenti recenti",
    noHistoryAvailable: "Nessuno storico disponibile",
    noIncidentsReported: "Nessun incidente segnalato",
    noRecentOutages: "Nessuna interruzione recente",
    overall: "Complessivo",
    close: "Chiudi",
    search: "Cerca",
    searchServices: "Cerca servizi...",
    selectTheme: "Seleziona tema",
    selectLanguage: "Seleziona lingua",
    links: "Collegamenti",
    to: "al",
    toPresent: "ad oggi",
    siteUpdates: "Aggiornamenti sito",
    footerText: "Fatto con ❤️",
    infoAndContacts: "Info & Contatti",
    terms: "Termini",
    privacy: "Privacy",
    termsTitle: "Termini di Servizio",
    termsContent: "I nostri Termini di Servizio spiegano i tuoi diritti e responsabilità quando utilizzi i nostri servizi.",
    privacyContent: "La nostra Informativa sulla Privacy descrive come gestiamo i tuoi dati personali e proteggiamo la tua privacy.",
    viewFullHistory: "Visualizza storia completa",
    subscribeToUpdates: "Iscriviti agli aggiornamenti",
    serviceDetails: "Dettagli servizio"
  },
  // ...altre traduzioni qui
  es: {
    // Base translations
    settings: "Ajustes",
    settingsDescription: "Personaliza tu experiencia cambiando el tema y el idioma",
    updates: "Actualizaciones",
    version: "Versión",

    // Themes and languages
    theme: "Tema",
    language: "Idioma",
    system: "Sistema",
    light: "Claro",
    dark: "Oscuro",
    english: "Inglés",
    italian: "Italiano",
    spanish: "Español",
    french: "Francés",
    german: "Alemán",
    chinese: "Chino",
    japanese: "Japonés",
    portuguese: "Portugués",
    russian: "Ruso",

    // Categories
    games: "Juegos",
    streaming: "Streaming",
    banking: "Banca",
    shopping: "Compras",
    social: "Social",
    mail: "Correo",
    various: "Varios",
    connection: "Conexión",
    browserai: "IA del Navegador",
    music: "Música",
    gaming: "Gaming",
    productivity: "Productividad",
    education: "Educación",
    technology: "Tecnología",
    entertainment: "Entretenimiento",
    financial: "Finanzas",
    orderBy: "Ordenar por",

    // Favorites
    favorites: "Favoritos",
    noFavorites: "No hay favoritos",
    addToFavorites: "Añadir a favoritos",
    removeFromFavorites: "Eliminar de favoritos",
    favoriteAdded: "Añadido a favoritos",
    favoriteRemoved: "Eliminado de favoritos",

    // Authentication
    login: "Iniciar sesión",
    register: "Registrarse",
    logout: "Cerrar sesión",
    admin: "Administrador",
    loggingIn: "Iniciando sesión...",
    loggingOut: "Cerrando sesión...",
    creatingAccount: "Creando cuenta...",
    loginDescription: "Inicia sesión para acceder a tu cuenta",
    registerDescription: "Crea una nueva cuenta",

    // Form placeholders
    emailPlaceholder: "Correo electrónico",
    passwordPlaceholder: "Contraseña",
    usernamePlaceholder: "Nombre de usuario",
    confirmPassword: "Confirmar contraseña",
    confirmPasswordPlaceholder: "Confirma tu contraseña",
    passwordMismatch: "Las contraseñas no coinciden",

    // Account
    accountTitle: "Mi cuenta",
    username: "Nombre de usuario",
    email: "Correo electrónico",
    role: "Rol",
    registeredAt: "Registrado el",

    // Status and operations
    serverStatus: "Estado del servidor",
    operational: "Operativo",
    degraded: "Degradado",
    down: "Caído",
    unknown: "Desconocido",
    error: "Error",
    success: "Éxito",
    partialOutage: "Caída parcial",

    // Dashboard elements
    dashboard: "Panel",
    dashboardDescription: "Estado de los servicios",
    heroDescription: "Monitor de estado de servicios en tiempo real",
    currentStatus: "Estado actual",
    categories: "Categorías",
    lastUpdated: "Última actualización",
    lastCheck: "Última comprobación",
    responseTime: "Tiempo de respuesta",
    checkingNow: "Comprobando ahora...",
    checkNow: "Comprobar ahora",
    viewDetails: "Ver detalles",
    backToDashboard: "Volver al panel",
    expand: "Expandir",
    collapse: "Colapsar",

    // Statistics and history
    uptime30d: "Disponibilidad 30d",
    lastOutage: "Última caída",
    avgResponse: "Tiempo de respuesta promedio",
    uptimeHistory: "Historial de disponibilidad",
    recentIncidents: "Incidentes recientes",
    noHistoryAvailable: "No hay historial disponible",
    noIncidentsReported: "No se han reportado incidentes",
    noRecentOutages: "No hay caídas recientes",
    overall: "General",

    // UI elements
    close: "Cerrar",
    search: "Buscar",
    searchServices: "Buscar servicios",
    selectTheme: "Seleccionar tema",
    selectLanguage: "Seleccionar idioma",
    links: "Enlaces",
    to: "hasta",
    toPresent: "hasta ahora",
    siteUpdates: "Actualizaciones del sitio",
    footerText: "Monitor de estado de servicios",
    infoAndContacts: "Información y contactos",

    // Legal
    terms: "Términos",
    privacy: "Privacidad",
    termsTitle: "Términos de uso",
    termsContent: "Términos de uso del servicio",
    privacyContent: "Política de privacidad",

    // Additional features
    viewFullHistory: "Ver historial completo",
    subscribeToUpdates: "Suscribirse a actualizaciones",
    serviceDetails: "Detalles del servicio"
  },
  fr: {
    // Base translations
    settings: "Paramètres",
    settingsDescription: "Personnalisez votre expérience en changeant le thème et la langue",
    updates: "Mises à jour",
    version: "Version",

    // Themes and languages
    theme: "Thème",
    language: "Langue",
    system: "Système",
    light: "Clair",
    dark: "Sombre",
    english: "Anglais",
    italian: "Italien",
    spanish: "Espagnol",
    french: "Français",
    german: "Allemand",
    chinese: "Chinois",
    japanese: "Japonais",
    portuguese: "Portugais",
    russian: "Russe",

    // Categories
    games: "Jeux",
    streaming: "Streaming",
    banking: "Banque",
    shopping: "Shopping",
    social: "Social",
    mail: "E-mail",
    various: "Divers",
    connection: "Connexion",
    browserai: "IA du navigateur",
    music: "Musique",
    gaming: "Gaming",
    productivity: "Productivité",
    education: "Éducation",
    technology: "Technologie",
    entertainment: "Divertissement",
    financial: "Finance",
    orderBy: "Trier par",

    // Favorites
    favorites: "Favoris",
    noFavorites: "Aucun favori",
    addToFavorites: "Ajouter aux favoris",
    removeFromFavorites: "Retirer des favoris",
    favoriteAdded: "Ajouté aux favoris",
    favoriteRemoved: "Retiré des favoris",

    // Authentication
    login: "Connexion",
    register: "S'inscrire",
    logout: "Déconnexion",
    admin: "Administrateur",
    loggingIn: "Connexion en cours...",
    loggingOut: "Déconnexion en cours...",
    creatingAccount: "Création du compte...",
    loginDescription: "Connectez-vous à votre compte",
    registerDescription: "Créez un nouveau compte",

    // Form placeholders
    emailPlaceholder: "Adresse e-mail",
    passwordPlaceholder: "Mot de passe",
    usernamePlaceholder: "Nom d'utilisateur",
    confirmPassword: "Confirmer le mot de passe",
    confirmPasswordPlaceholder: "Confirmez votre mot de passe",
    passwordMismatch: "Les mots de passe ne correspondent pas",

    // Account
    accountTitle: "Mon compte",
    username: "Nom d'utilisateur",
    email: "E-mail",
    role: "Rôle",
    registeredAt: "Inscrit le",

    // Status and operations
    serverStatus: "État du serveur",
    operational: "Opérationnel",
    degraded: "Dégradé",
    down: "Hors service",
    unknown: "Inconnu",
    error: "Erreur",
    success: "Succès",
    partialOutage: "Panne partielle",

    // Dashboard elements
    dashboard: "Tableau de bord",
    dashboardDescription: "État des services",
    heroDescription: "Moniteur d'état des services en temps réel",
    currentStatus: "État actuel",
    categories: "Catégories",
    lastUpdated: "Dernière mise à jour",
    lastCheck: "Dernière vérification",
    responseTime: "Temps de réponse",
    checkingNow: "Vérification en cours...",
    checkNow: "Vérifier maintenant",
    viewDetails: "Voir les détails",
    backToDashboard: "Retour au tableau de bord",
    expand: "Développer",
    collapse: "Réduire",

    // Statistics and history
    uptime30d: "Disponibilité 30j",
    lastOutage: "Dernière panne",
    avgResponse: "Temps de réponse moyen",
    uptimeHistory: "Historique de disponibilité",
    recentIncidents: "Incidents récents",
    noHistoryAvailable: "Aucun historique disponible",
    noIncidentsReported: "Aucun incident signalé",
    noRecentOutages: "Aucune panne récente",
    overall: "Général",

    // UI elements
    close: "Fermer",
    search: "Rechercher",
    searchServices: "Rechercher des services",
    selectTheme: "Sélectionner le thème",
    selectLanguage: "Sélectionner la langue",
    links: "Liens",
    to: "à",
    toPresent: "jusqu'à maintenant",
    siteUpdates: "Mises à jour du site",
    footerText: "Moniteur d'état des services",
    infoAndContacts: "Informations et contacts",

    // Legal
    terms: "Conditions",
    privacy: "Confidentialité",
    termsTitle: "Conditions d'utilisation",
    termsContent: "Conditions d'utilisation du service",
    privacyContent: "Politique de confidentialité",

    // Additional features
    viewFullHistory: "Voir l'historique complet",
    subscribeToUpdates: "S'abonner aux mises à jour",
    serviceDetails: "Détails du service"
  },
  de: {
    // Base translations
    settings: "Einstellungen",
    settingsDescription: "Passen Sie Ihr Erlebnis durch Ändern von Thema und Sprache an",
    updates: "Updates",
    version: "Version",

    // Themes and languages
    theme: "Thema",
    language: "Sprache",
    system: "System",
    light: "Hell",
    dark: "Dunkel",
    english: "Englisch",
    italian: "Italienisch",
    spanish: "Spanisch",
    french: "Französisch",
    german: "Deutsch",
    chinese: "Chinesisch",
    japanese: "Japanisch",
    portuguese: "Portugiesisch",
    russian: "Russisch",

    // Categories
    games: "Spiele",
    streaming: "Streaming",
    banking: "Banking",
    shopping: "Shopping",
    social: "Sozial",
    mail: "E-Mail",
    various: "Verschiedenes",
    connection: "Verbindung",
    browserai: "Browser-KI",
    music: "Musik",
    gaming: "Gaming",
    productivity: "Produktivität",
    education: "Bildung",
    technology: "Technologie",
    entertainment: "Unterhaltung",
    financial: "Finanzen",
    orderBy: "Sortieren nach",

    // Favorites
    favorites: "Favoriten",
    noFavorites: "Keine Favoriten",
    addToFavorites: "Zu Favoriten hinzufügen",
    removeFromFavorites: "Aus Favoriten entfernen",
    favoriteAdded: "Zu Favoriten hinzugefügt",
    favoriteRemoved: "Aus Favoriten entfernt",

    // Authentication
    login: "Anmelden",
    register: "Registrieren",
    logout: "Abmelden",
    admin: "Administrator",
    loggingIn: "Anmeldung läuft...",
    loggingOut: "Abmeldung läuft...",
    creatingAccount: "Konto wird erstellt...",
    loginDescription: "Melden Sie sich bei Ihrem Konto an",
    registerDescription: "Erstellen Sie ein neues Konto",

    // Form placeholders
    emailPlaceholder: "E-Mail-Adresse",
    passwordPlaceholder: "Passwort",
    usernamePlaceholder: "Benutzername",
    confirmPassword: "Passwort bestätigen",
    confirmPasswordPlaceholder: "Bestätigen Sie Ihr Passwort",
    passwordMismatch: "Passwörter stimmen nicht überein",

    // Account
    accountTitle: "Mein Konto",
    username: "Benutzername",
    email: "E-Mail",
    role: "Rolle",
    registeredAt: "Registriert am",

    // Status and operations
    serverStatus: "Serverstatus",
    operational: "Betriebsbereit",
    degraded: "Beeinträchtigt",
    down: "Ausgefallen",
    unknown: "Unbekannt",
    error: "Fehler",
    success: "Erfolg",
    partialOutage: "Teilausfall",

    // Dashboard elements
    dashboard: "Dashboard",
    dashboardDescription: "Servicestatus",
    heroDescription: "Echtzeit-Service-Statusmonitor",
    currentStatus: "Aktueller Status",
    categories: "Kategorien",
    lastUpdated: "Zuletzt aktualisiert",
    lastCheck: "Letzte Prüfung",
    responseTime: "Antwortzeit",
    checkingNow: "Wird geprüft...",
    checkNow: "Jetzt prüfen",
    viewDetails: "Details anzeigen",
    backToDashboard: "Zurück zum Dashboard",
    expand: "Erweitern",
    collapse: "Reduzieren",

    // Statistics and history
    uptime30d: "Verfügbarkeit 30T",
    lastOutage: "Letzter Ausfall",
    avgResponse: "Durchschnittliche Antwortzeit",
    uptimeHistory: "Verfügbarkeitsverlauf",
    recentIncidents: "Aktuelle Vorfälle",
    noHistoryAvailable: "Kein Verlauf verfügbar",
    noIncidentsReported: "Keine Vorfälle gemeldet",
    noRecentOutages: "Keine kürzlichen Ausfälle",
    overall: "Gesamt",

    // UI elements
    close: "Schließen",
    search: "Suchen",
    searchServices: "Services suchen",
    selectTheme: "Thema auswählen",
    selectLanguage: "Sprache auswählen",
    links: "Links",
    to: "bis",
    toPresent: "bis jetzt",
    siteUpdates: "Seiten-Updates",
    footerText: "Service-Statusmonitor",
    infoAndContacts: "Informationen und Kontakte",

    // Legal
    terms: "Nutzungsbedingungen",
    privacy: "Datenschutz",
    termsTitle: "Nutzungsbedingungen",
    termsContent: "Nutzungsbedingungen des Services",
    privacyContent: "Datenschutzerklärung",

    // Additional features
    viewFullHistory: "Vollständigen Verlauf anzeigen",
    subscribeToUpdates: "Updates abonnieren",
    serviceDetails: "Service-Details"
  },
  zh: {
    // Base translations
    settings: "设置",
    settingsDescription: "通过更改主题和语言自定义您的体验",
    updates: "更新",
    version: "版本",

    // Themes and languages
    theme: "主题",
    language: "语言",
    system: "系统",
    light: "浅色",
    dark: "深色",
    english: "英语",
    italian: "意大利语",
    spanish: "西班牙语",
    french: "法语",
    german: "德语",
    chinese: "中文",
    japanese: "日语",
    portuguese: "葡萄牙语",
    russian: "俄语",

    // Categories
    games: "游戏",
    streaming: "流媒体",
    banking: "银行",
    shopping: "购物",
    social: "社交",
    mail: "邮件",
    various: "其他",
    connection: "连接",
    browserai: "浏览器AI",
    music: "音乐",
    gaming: "游戏",
    productivity: "生产力",
    education: "教育",
    technology: "技术",
    entertainment: "娱乐",
    financial: "金融",
    orderBy: "排序方式",

    // Favorites
    favorites: "收藏",
    noFavorites: "暂无收藏",
    addToFavorites: "添加到收藏",
    removeFromFavorites: "从收藏中移除",
    favoriteAdded: "已添加到收藏",
    favoriteRemoved: "已从收藏中移除",

    // Authentication
    login: "登录",
    register: "注册",
    logout: "退出",
    admin: "管理员",
    loggingIn: "正在登录...",
    loggingOut: "正在退出...",
    creatingAccount: "正在创建账户...",
    loginDescription: "登录您的账户",
    registerDescription: "创建新账户",

    // Form placeholders
    emailPlaceholder: "电子邮箱",
    passwordPlaceholder: "密码",
    usernamePlaceholder: "用户名",
    confirmPassword: "确认密码",
    confirmPasswordPlaceholder: "确认您的密码",
    passwordMismatch: "密码不匹配",

    // Account
    accountTitle: "我的账户",
    username: "用户名",
    email: "电子邮箱",
    role: "角色",
    registeredAt: "注册时间",

    // Status and operations
    serverStatus: "服务器状态",
    operational: "正常运行",
    degraded: "性能降级",
    down: "服务中断",
    unknown: "未知",
    error: "错误",
    success: "成功",
    partialOutage: "部分中断",

    // Dashboard elements
    dashboard: "仪表板",
    dashboardDescription: "服务状态",
    heroDescription: "实时服务状态监控",
    currentStatus: "当前状态",
    categories: "类别",
    lastUpdated: "最后更新",
    lastCheck: "最后检查",
    responseTime: "响应时间",
    checkingNow: "正在检查...",
    checkNow: "立即检查",
    viewDetails: "查看详情",
    backToDashboard: "返回仪表板",
    expand: "展开",
    collapse: "收起",

    // Statistics and history
    uptime30d: "30天可用性",
    lastOutage: "最后中断",
    avgResponse: "平均响应时间",
    uptimeHistory: "可用性历史",
    recentIncidents: "最近事件",
    noHistoryAvailable: "暂无历史记录",
    noIncidentsReported: "无事件报告",
    noRecentOutages: "无最近中断",
    overall: "总体",

    // UI elements
    close: "关闭",
    search: "搜索",
    searchServices: "搜索服务",
    selectTheme: "选择主题",
    selectLanguage: "选择语言",
    links: "链接",
    to: "至",
    toPresent: "至今",
    siteUpdates: "网站更新",
    footerText: "服务状态监控",
    infoAndContacts: "信息与联系",

    // Legal
    terms: "条款",
    privacy: "隐私",
    termsTitle: "使用条款",
    termsContent: "服务使用条款",
    privacyContent: "隐私政策",

    // Additional features
    viewFullHistory: "查看完整历史",
    subscribeToUpdates: "订阅更新",
    serviceDetails: "服务详情"
  },
  ja: {
    // Base translations
    settings: "設定",
    settingsDescription: "テーマと言語を変更してカスタマイズ",
    updates: "アップデート",
    version: "バージョン",

    // Themes and languages
    theme: "テーマ",
    language: "言語",
    system: "システム",
    light: "ライト",
    dark: "ダーク",
    english: "英語",
    italian: "イタリア語",
    spanish: "スペイン語",
    french: "フランス語",
    german: "ドイツ語",
    chinese: "中国語",
    japanese: "日本語",
    portuguese: "ポルトガル語",
    russian: "ロシア語",

    // Categories
    games: "ゲーム",
    streaming: "ストリーミング",
    banking: "銀行",
    shopping: "ショッピング",
    social: "ソーシャル",
    mail: "メール",
    various: "その他",
    connection: "接続",
    browserai: "ブラウザAI",
    music: "音楽",
    gaming: "ゲーミング",
    productivity: "生産性",
    education: "教育",
    technology: "テクノロジー",
    entertainment: "エンターテイメント",
    financial: "金融",
    orderBy: "並び替え",

    // Favorites
    favorites: "お気に入り",
    noFavorites: "お気に入りなし",
    addToFavorites: "お気に入りに追加",
    removeFromFavorites: "お気に入りから削除",
    favoriteAdded: "お気に入りに追加しました",
    favoriteRemoved: "お気に入りから削除しました",

    // Authentication
    login: "ログイン",
    register: "登録",
    logout: "ログアウト",
    admin: "管理者",
    loggingIn: "ログイン中...",
    loggingOut: "ログアウト中...",
    creatingAccount: "アカウント作成中...",
    loginDescription: "アカウントにログイン",
    registerDescription: "新規アカウント作成",

    // Form placeholders
    emailPlaceholder: "メールアドレス",
    passwordPlaceholder: "パスワード",
    usernamePlaceholder: "ユーザー名",
    confirmPassword: "パスワード確認",
    confirmPasswordPlaceholder: "パスワードを確認",
    passwordMismatch: "パスワードが一致しません",

    // Account
    accountTitle: "マイアカウント",
    username: "ユーザー名",
    email: "メール",
    role: "役割",
    registeredAt: "登録日",

    // Status and operations
    serverStatus: "サーバーステータス",
    operational: "正常稼働中",
    degraded: "パフォーマンス低下",
    down: "停止中",
    unknown: "不明",
    error: "エラー",
    success: "成功",
    partialOutage: "一部停止",

    // Dashboard elements
    dashboard: "ダッシュボード",
    dashboardDescription: "サービスステータス",
    heroDescription: "リアルタイムサービスステータスモニター",
    currentStatus: "現在のステータス",
    categories: "カテゴリー",
    lastUpdated: "最終更新",
    lastCheck: "最終確認",
    responseTime: "応答時間",
    checkingNow: "確認中...",
    checkNow: "今すぐ確認",
    viewDetails: "詳細を表示",
    backToDashboard: "ダッシュボードに戻る",
    expand: "展開",
    collapse: "折りたたむ",

    // Statistics and history
    uptime30d: "30日間の稼働率",
    lastOutage: "最後の停止",
    avgResponse: "平均応答時間",
    uptimeHistory: "稼働履歴",
    recentIncidents: "最近のインシデント",
    noHistoryAvailable: "履歴なし",
    noIncidentsReported: "インシデントなし",
    noRecentOutages: "最近の停止なし",
    overall: "全体",

    // UI elements
    close: "閉じる",
    search: "検索",
    searchServices: "サービスを検索",
    selectTheme: "テーマを選択",
    selectLanguage: "言語を選択",
    links: "リンク",
    to: "まで",
    toPresent: "現在まで",
    siteUpdates: "サイト更新情報",
    footerText: "サービスステータスモニター",
    infoAndContacts: "情報とお問い合わせ",

    // Legal
    terms: "利用規約",
    privacy: "プライバシー",
    termsTitle: "利用規約",
    termsContent: "サービス利用規約",
    privacyContent: "プライバシーポリシー",

    // Additional features
    viewFullHistory: "全履歴を表示",
    subscribeToUpdates: "更新情報を購読",
    serviceDetails: "サービス詳細"
  },
  pt: {
    // Base translations
    settings: "Configurações",
    settingsDescription: "Personalize sua experiência alterando o tema e o idioma",
    updates: "Atualizações",
    version: "Versão",

    // Themes and languages
    theme: "Tema",
    language: "Idioma",
    system: "Sistema",
    light: "Claro",
    dark: "Escuro",
    english: "Inglês",
    italian: "Italiano",
    spanish: "Espanhol",
    french: "Francês",
    german: "Alemão",
    chinese: "Chinês",
    japanese: "Japonês",
    portuguese: "Português",
    russian: "Russo",

    // Categories
    games: "Jogos",
    streaming: "Streaming",
    banking: "Bancário",
    shopping: "Compras",
    social: "Social",
    mail: "E-mail",
    various: "Diversos",
    connection: "Conexão",
    browserai: "IA do Navegador",
    music: "Música",
    gaming: "Gaming",
    productivity: "Produtividade",
    education: "Educação",
    technology: "Tecnologia",
    entertainment: "Entretenimento",
    financial: "Financeiro",
    orderBy: "Ordenar por",

    // Favorites
    favorites: "Favoritos",
    noFavorites: "Sem favoritos",
    addToFavorites: "Adicionar aos favoritos",
    removeFromFavorites: "Remover dos favoritos",
    favoriteAdded: "Adicionado aos favoritos",
    favoriteRemoved: "Removido dos favoritos",

    // Authentication
    login: "Entrar",
    register: "Registrar",
    logout: "Sair",
    admin: "Administrador",
    loggingIn: "Entrando...",
    loggingOut: "Saindo...",
    creatingAccount: "Criando conta...",
    loginDescription: "Entre na sua conta",
    registerDescription: "Crie uma nova conta",

    // Form placeholders
    emailPlaceholder: "E-mail",
    passwordPlaceholder: "Senha",
    usernamePlaceholder: "Nome de usuário",
    confirmPassword: "Confirmar senha",
    confirmPasswordPlaceholder: "Confirme sua senha",
    passwordMismatch: "As senhas não coincidem",

    // Account
    accountTitle: "Minha conta",
    username: "Nome de usuário",
    email: "E-mail",
    role: "Função",
    registeredAt: "Registrado em",

    // Status and operations
    serverStatus: "Status do servidor",
    operational: "Operacional",
    degraded: "Degradado",
    down: "Fora do ar",
    unknown: "Desconhecido",
    error: "Erro",
    success: "Sucesso",
    partialOutage: "Falha parcial",

    // Dashboard elements
    dashboard: "Painel",
    dashboardDescription: "Status dos serviços",
    heroDescription: "Monitor de status dos serviços em tempo real",
    currentStatus: "Status atual",
    categories: "Categorias",
    lastUpdated: "Última atualização",
    lastCheck: "Última verificação",
    responseTime: "Tempo de resposta",
    checkingNow: "Verificando agora...",
    checkNow: "Verificar agora",
    viewDetails: "Ver detalhes",
    backToDashboard: "Voltar ao painel",
    expand: "Expandir",
    collapse: "Recolher",

    // Statistics and history
    uptime30d: "Disponibilidade 30d",
    lastOutage: "Última falha",
    avgResponse: "Tempo médio de resposta",
    uptimeHistory: "Histórico de disponibilidade",
    recentIncidents: "Incidentes recentes",
    noHistoryAvailable: "Sem histórico disponível",
    noIncidentsReported: "Nenhum incidente reportado",
    noRecentOutages: "Sem falhas recentes",
    overall: "Geral",

    // UI elements
    close: "Fechar",
    search: "Buscar",
    searchServices: "Buscar serviços",
    selectTheme: "Selecionar tema",
    selectLanguage: "Selecionar idioma",
    links: "Links",
    to: "até",
    toPresent: "até agora",
    siteUpdates: "Atualizações do site",
    footerText: "Monitor de status dos serviços",
    infoAndContacts: "Informações e contatos",

    // Legal
    terms: "Termos",
    privacy: "Privacidade",
    termsTitle: "Termos de uso",
    termsContent: "Termos de uso do serviço",
    privacyContent: "Política de privacidade",

    // Additional features
    viewFullHistory: "Ver histórico completo",
    subscribeToUpdates: "Inscrever-se para atualizações",
    serviceDetails: "Detalhes do serviço"
  },
  ru: {
    // Base translations
    settings: "Настройки",
    settingsDescription: "Настройте свой опыт, изменяя тему и язык",
    updates: "Обновления",
    version: "Версия",

    // Themes and languages
    theme: "Тема",
    language: "Язык",
    system: "Системная",
    light: "Светлая",
    dark: "Тёмная",
    english: "Английский",
    italian: "Итальянский",
    spanish: "Испанский",
    french: "Французский",
    german: "Немецкий",
    chinese: "Китайский",
    japanese: "Японский",
    portuguese: "Португальский",
    russian: "Русский",

    // Categories
    games: "Игры",
    streaming: "Стриминг",
    banking: "Банкинг",
    shopping: "Покупки",
    social: "Соцсети",
    mail: "Почта",
    various: "Разное",
    connection: "Подключение",
    browserai: "ИИ браузера",
    music: "Музыка",
    gaming: "Игры",
    productivity: "Продуктивность",
    education: "Образование",
    technology: "Технологии",
    entertainment: "Развлечения",
    financial: "Финансы",
    orderBy: "Сортировать по",

    // Favorites
    favorites: "Избранное",
    noFavorites: "Нет избранного",
    addToFavorites: "Добавить в избранное",
    removeFromFavorites: "Удалить из избранного",
    favoriteAdded: "Добавлено в избранное",
    favoriteRemoved: "Удалено из избранного",

    // Authentication
    login: "Войти",
    register: "Регистрация",
    logout: "Выйти",
    admin: "Администратор",
    loggingIn: "Вход...",
    loggingOut: "Выход...",
    creatingAccount: "Создание аккаунта...",
    loginDescription: "Войдите в свой аккаунт",
    registerDescription: "Создайте новый аккаунт",

    // Form placeholders
    emailPlaceholder: "Электронная почта",
    passwordPlaceholder: "Пароль",
    usernamePlaceholder: "Имя пользователя",
    confirmPassword: "Подтвердите пароль",
    confirmPasswordPlaceholder: "Подтвердите ваш пароль",
    passwordMismatch: "Пароли не совпадают",

    // Account
    accountTitle: "Мой аккаунт",
    username: "Имя пользователя",
    email: "Почта",
    role: "Роль",
    registeredAt: "Дата регистрации",

    // Status and operations
    serverStatus: "Статус сервера",
    operational: "Работает",
    degraded: "Ухудшение",
    down: "Не работает",
    unknown: "Неизвестно",
    error: "Ошибка",
    success: "Успешно",
    partialOutage: "Частичный сбой",

    // Dashboard elements
    dashboard: "Панель",
    dashboardDescription: "Статус сервисов",
    heroDescription: "Монитор статуса сервисов в реальном времени",
    currentStatus: "Текущий статус",
    categories: "Категории",
    lastUpdated: "Последнее обновление",
    lastCheck: "Последняя проверка",
    responseTime: "Время отклика",
    checkingNow: "Проверка...",
    checkNow: "Проверить сейчас",
    viewDetails: "Подробности",
    backToDashboard: "Вернуться к панели",
    expand: "Развернуть",
    collapse: "Свернуть",

    // Statistics and history
    uptime30d: "Доступность 30д",
    lastOutage: "Последний сбой",
    avgResponse: "Среднее время отклика",
    uptimeHistory: "История доступности",
    recentIncidents: "Недавние инциденты",
    noHistoryAvailable: "История недоступна",
    noIncidentsReported: "Инцидентов не зарегистрировано",
    noRecentOutages: "Недавних сбоев нет",
    overall: "Общий",

    // UI elements
    close: "Закрыть",
    search: "Поиск",
    searchServices: "Поиск сервисов",
    selectTheme: "Выбрать тему",
    selectLanguage: "Выбрать язык",
    links: "Ссылки",
    to: "до",
    toPresent: "по настоящее время",
    siteUpdates: "Обновления сайта",
    footerText: "Монитор статуса сервисов",
    infoAndContacts: "Информация и контакты",

    // Legal
    terms: "Условия",
    privacy: "Конфиденциальность",
    termsTitle: "Условия использования",
    termsContent: "Условия использования сервиса",
    privacyContent: "Политика конфиденциальности",

    // Additional features
    viewFullHistory: "Посмотреть полную историю",
    subscribeToUpdates: "Подписаться на обновления",
    serviceDetails: "Детали сервиса"
  }
};

// Definizione del tipo di contesto per le impostazioni
export interface SettingsContextType {
  theme: string;
  language: string;
  t: (key: keyof Translation) => string;
  setTheme: (theme: string) => void;
  setLanguage: (lang: string) => void;
  favorites: string[];
  isFavorite: (id: string) => boolean;
  addFavorite: (id: string) => void;
  removeFavorite: (id: string) => void;
}

// Creazione del contesto
const SettingsContext = createContext<SettingsContextType | undefined>(undefined);

// Hook personalizzato per utilizzare le impostazioni
export const useSettings = () => {
  const context = useContext(SettingsContext);
  if (!context) {
    throw new Error('useSettings must be used within a SettingsProvider');
  }
  return context;
};

// Provider component
export const SettingsProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [theme, setTheme] = useState<string>(() => {
    const saved = localStorage.getItem('theme');
    return saved || 'system';
  });

  const [language, setLanguage] = useState<string>(() => {
    const saved = localStorage.getItem('language');
    return saved || 'en';
  });

  const [favorites, setFavorites] = useState<string[]>(() => {
    const saved = localStorage.getItem('favorites');
    return saved ? JSON.parse(saved) : [];
  });

  // Effetti per salvare le impostazioni
  useEffect(() => {
    localStorage.setItem('theme', theme);
  }, [theme]);

  useEffect(() => {
    localStorage.setItem('language', language);
  }, [language]);

  useEffect(() => {
    localStorage.setItem('favorites', JSON.stringify(favorites));
  }, [favorites]);

  // Funzione per ottenere le traduzioni
  const t = useCallback((key: keyof Translation) => {
    const translations = allTranslations[language as keyof typeof allTranslations];
    return translations?.[key] || allTranslations.en[key] || key;
  }, [language]);

  // Gestione dei preferiti
  const isFavorite = useCallback((id: string) => favorites.includes(id), [favorites]);

  const addFavorite = useCallback((id: string) => {
    setFavorites(prev => [...new Set([...prev, id])]);
  }, []);

  const removeFavorite = useCallback((id: string) => {
    setFavorites(prev => prev.filter(favId => favId !== id));
  }, []);

  const value = {
    theme,
    language,
    t,
    setTheme,
    setLanguage,
    favorites,
    isFavorite,
    addFavorite,
    removeFavorite
  };

  return (
    <SettingsContext.Provider value={value}>
      {children}
    </SettingsContext.Provider>
  );
};
interface SettingsContextType {
  theme: Theme;
  setTheme: (theme: Theme) => void;
  language: Language;
  setLanguage: (language: Language) => void;
  t: (key: keyof Translation) => string;
}

const SettingsContext = createContext<SettingsContextType | undefined>(undefined);

interface SettingsProviderProps {
  children: ReactNode;
}

export function SettingsProvider({ children }: SettingsProviderProps) {
  const { toast } = useToast();
  const [theme, setTheme] = useState<Theme>('system');
  const [language, setLanguage] = useState<Language>('en');

  useEffect(() => {
    const savedTheme = localStorage.getItem('theme') as Theme;
    const savedLanguage = localStorage.getItem('language') as Language;
    
    if (savedTheme) setTheme(savedTheme);
    if (savedLanguage) setLanguage(savedLanguage);
    
    // Applica il tema iniziale
    applyTheme(savedTheme || 'system');
  }, []);

  // Cambia il tema
  const handleThemeChange = (newTheme: Theme) => {
    setTheme(newTheme);
    localStorage.setItem('theme', newTheme);
    applyTheme(newTheme);
  };

  // Cambia la lingua
  const handleLanguageChange = (newLanguage: Language) => {
    setLanguage(newLanguage);
    localStorage.setItem('language', newLanguage);
  };

  // Funzione per ottenere una traduzione
  const t = (key: keyof Translation) => {
    return translations[language][key] || translations['en'][key] || key;
  };

  // Applica il tema
  const applyTheme = (theme: Theme) => {
    if (theme === 'system') {
      const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      document.documentElement.classList.toggle('dark', systemTheme === 'dark');
    } else {
      document.documentElement.classList.toggle('dark', theme === 'dark');
    }
  };

  return (
    <SettingsContext.Provider
      value={{
        theme,
        setTheme: handleThemeChange,
        language,
        setLanguage: handleLanguageChange,
        t,
      }}
    >
      {children}
    </SettingsContext.Provider>
  );
}

export function useSettings() {
  const context = useContext(SettingsContext);
  if (!context) {
    throw new Error('useSettings must be used within a SettingsProvider');
  }
  return context;
}