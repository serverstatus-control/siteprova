import{aJ as e,j as s,r as t,e as a}from"./react-vendor-BC-NryIe.js";import{c as r}from"./router-MOUxwqPK.js";import{u as i,T as n,a as d,b as l,c,f as m,H as o,S as x,M as h,g,d as u,F as j,l as p}from"./index-CRa19pyD.js";import{Z as f,H as N,G as v,I as y,J as b,K as w,L as $,N as k,O as T,P as H}from"./vendor-BQl0nyRy.js";import"./radix-ui-ByoYm48K.js";import"./forms-Cf6uUqBP.js";const S={it:v,en:N,es:y,fr:b,de:w,pt:$,ru:k,zh:T,ja:H},L=({history:t})=>{const{t:a,language:r}=i(),m=[...t].sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime()),[o,x]=e.useState(!1);return e.useEffect(()=>{const e=setTimeout(()=>x(!0),50);return()=>clearTimeout(e)},[]),s.jsx(n,{children:s.jsx("div",{className:"space-y-3",children:m.map((e,t)=>{const a=(i=e.status,n=e.uptimePercentage,"down"===i?"bg-danger":"degraded"===i||n<95?"bg-warning":"bg-success");var i,n;const m=((e,s)=>"down"===e?"text-danger":"degraded"===e||s<95?"text-warning":"text-success")(e.status,e.uptimePercentage),x=(e=>{const s=new Date(e);return f(s,"d MMM HH:mm",{locale:S[r]||N})})(e.date),h=`${e.uptimePercentage}% uptime - ${e.status.charAt(0).toUpperCase()+e.status.slice(1)}`;return s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-xs text-gray-400 w-20",children:x}),s.jsxs(d,{children:[s.jsx(l,{asChild:!0,children:s.jsx("div",{className:"flex-1 h-3 rounded overflow-hidden bg-dark-light cursor-pointer",children:s.jsx("div",{className:`${a} h-full rounded transition-all duration-700 ease-out`,style:{width:o?`${e.uptimePercentage}%`:"0%"},"aria-hidden":!0})})}),s.jsx(c,{side:"top",children:h})]}),s.jsxs("span",{className:`text-xs font-mono px-2 py-0.5 rounded-full ${m} bg-opacity-90 bg-gray-800 text-white font-semibold shadow`,children:[e.uptimePercentage,"%"]})]},t)})})})},M=()=>{const[e,n]=r("/services/:slug"),[d,l]=t.useState(!1),[c,N]=t.useState(""),{data:v=[],isLoading:y}=a({queryKey:["/api/categories"]}),{data:b=null,isLoading:w}=a({queryKey:["/api/status-summary"]}),{data:$,isLoading:k,error:T}=a({queryKey:[`/api/services/${n?.slug}`],enabled:!!n?.slug,refetchInterval:864e5,refetchOnWindowFocus:!1}),{data:H=[],isLoading:S}=a({queryKey:["/api/services"]}),{data:M=[],isLoading:P}=a({queryKey:[`/api/services/${$?.id}/history`],enabled:!!$?.id,refetchInterval:864e5,refetchOnWindowFocus:!1}),{data:C=[],isLoading:K}=a({queryKey:[`/api/services/${$?.id}/incidents`],enabled:!!$?.id}),O=()=>{l(!d)},{t:q,language:D}=i(),I=(e,s)=>{const t=f(new Date(e),"MMM d, yyyy - HH:mm",{locale:p[D]});return s?`${t} ${q.to||"to"} ${f(new Date(s),"HH:mm",{locale:p[D]})}`:`${t} ${q.toPresent||"to present"}`};if(y||w||k||P||K||S)return s.jsx("div",{className:"min-h-screen bg-dark flex items-center justify-center",children:s.jsx("div",{className:"text-white text-xl",children:"Loading service details..."})});if(T||!$)return s.jsx("div",{className:"min-h-screen bg-dark flex items-center justify-center",children:s.jsx("div",{className:"text-white text-xl",children:"Service not found"})});const R=$.lastChecked?m($.lastChecked,D):q.unknown||"Unknown";return s.jsxs("div",{className:"bg-dark text-gray-100 font-sans min-h-screen",children:[s.jsx(o,{onMenuToggle:O,onSearch:e=>{N(e)},services:H}),s.jsxs("div",{className:"flex min-h-[calc(100vh-64px)]",children:[s.jsx(x,{categories:v,statusSummary:b}),s.jsx(h,{isOpen:d,onClose:O,categories:v,statusSummary:b}),s.jsx("main",{className:"flex-1 lg:ml-64 pb-12",children:s.jsx("div",{className:"container mx-auto px-4 py-6",children:s.jsxs("div",{className:"mb-6",children:[s.jsxs("a",{href:"/",className:"text-primary hover:text-blue-400 mb-4 inline-flex items-center",children:[s.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Dashboard"]}),s.jsxs("div",{className:"bg-dark-light p-6 rounded-lg border border-dark-lighter mt-4",children:[s.jsxs("div",{className:"flex items-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-dark-lighter rounded-full flex items-center justify-center mr-6",children:s.jsx("i",{className:`${$.logo||g($.name)} text-3xl`})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:$.name}),s.jsxs("div",{className:"flex items-center mt-2",children:[s.jsx(u,{status:$.status,className:"mr-3"}),s.jsxs("span",{className:"text-sm text-gray-400",children:[q.lastCheck,": ",R]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:q.currentStatus||"Current Status"}),s.jsx("div",{className:"bg-dark-lighter rounded-lg p-4",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:q.responseTime||"Response Time"}),s.jsx("p",{className:"font-mono text-lg",children:"down"===$.status?"Timeout":`${$.responseTime}ms`})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:q.uptime30d||"Uptime (30 days)"}),s.jsxs("p",{className:"font-mono text-lg",children:[$.uptimePercentage,"%"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:q.lastOutage||"Last Outage"}),s.jsx("p",{className:"font-mono text-lg",children:C.length>0?m(C[0].startTime,D):q.noRecentOutages||"No recent outages"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:q.avgResponse||"Avg. Response"}),s.jsx("p",{className:"font-mono text-lg",children:"down"===$.status?"N/A":`${Math.round(M.reduce((e,s)=>e+s.responseTime,0)/(M.length||1))}ms`})]})]})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:q.uptimeHistory||"Uptime History"}),s.jsx("div",{className:"bg-dark-lighter rounded-lg p-4",children:M.length>0?s.jsx(L,{history:M}):s.jsx("p",{className:"text-sm text-gray-400",children:q.noHistoryAvailable||"No history available"})})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-4",children:q.recentIncidents||"Recent Incidents"}),s.jsx("div",{className:"bg-dark-lighter rounded-lg p-4",children:C.length>0?s.jsx("div",{className:"space-y-4",children:C.map(e=>s.jsx("div",{className:"pb-4 border-b border-gray-700 last:border-0 last:pb-0",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 rounded-full bg-${"down"===e.status?"danger":"warning"} bg-opacity-20 text-${"down"===e.status?"danger":"warning"} mt-0.5 mr-3`,children:s.jsx("i",{className:`fas fa-${"down"===e.status?"exclamation-circle":"exclamation-triangle"} text-sm`})}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium mb-1",children:e.title}),s.jsx("p",{className:"text-sm text-gray-400 mb-2",children:e.description}),s.jsx("div",{className:"text-xs text-gray-500 font-mono",children:I(e.startTime,e.endTime)})]})]})},e.id))}):s.jsx("p",{className:"text-sm text-gray-400",children:q.noIncidentsReported||"No incidents reported"})})]})]})]})})})]}),s.jsx(j,{})]})};export{M as default};
