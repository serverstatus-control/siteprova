import{aI as e,j as t,r as s,l as a}from"./react-vendor-BNEYYyHa.js";import{c as i}from"./router-hJKavJLj.js";import{u as r,T as n,a as l,b as d,f as c,H as o,S as m,M as x,g,c as h,F as u,l as f}from"./index-CtS2zGTh.js";import{al as p,a5 as j,a6 as b,a7 as y,a8 as v,a9 as N,aa as w,ab as T,ac as k,ad as S}from"./vendor-CVm9KD9f.js";import"./radix-ui-ByoYm48K.js";import"./forms-BLyFeey8.js";const $={it:S,en:k,es:T,fr:w,de:N,pt:v,ru:y,zh:b,ja:j},P=({history:s})=>{const{t:a,language:i}=r(),c=[...s].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()),[o,m]=e.useState(!1);return e.useEffect(()=>{const e=setTimeout(()=>m(!0),50);return()=>clearTimeout(e)},[]),t.jsx("div",{className:"space-y-3",children:c.map((e,s)=>{const a=(r=e.status,c=e.uptimePercentage,"down"===r?"bg-danger":"degraded"===r||c<95?"bg-warning":"bg-success");var r,c;const m=((e,t)=>"down"===e?"text-danger":"degraded"===e||t<95?"text-warning":"text-success")(e.status,e.uptimePercentage),x=(e=>{const t=new Date(e);return p(t,"d MMM HH:mm",{locale:$[i]||k})})(e.date),g=`${e.uptimePercentage}% uptime - ${e.status.charAt(0).toUpperCase()+e.status.slice(1)}`;return t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-xs text-gray-400 w-20",children:x}),t.jsxs(n,{children:[t.jsx(l,{asChild:!0,children:t.jsx("div",{className:"flex-1 h-3 rounded overflow-hidden bg-dark-light cursor-pointer",children:t.jsx("div",{className:`${a} h-full rounded transition-all duration-700 ease-out`,style:{width:o?`${e.uptimePercentage}%`:"0%"},"aria-hidden":!0})})}),t.jsx(d,{side:"top",children:g})]}),t.jsxs("span",{className:`text-xs font-mono px-2 py-0.5 rounded-full ${m} bg-opacity-90 bg-gray-800 text-white font-semibold shadow`,children:[e.uptimePercentage,"%"]})]},s)})})},C=({history:e,className:a=""})=>{const i=s.useRef(null),{t:n}=r(),l=()=>{const t=i.current;if(!t)return;const s=t.getContext("2d");if(!s)return;const a=(()=>{const t=(new Date).getTime()-864e5,s=e.map(e=>({...e,dateObj:new Date(e.date)})).filter(e=>e.dateObj.getTime()>=t).sort((e,t)=>e.dateObj.getTime()-t.dateObj.getTime()),a=new Map;for(const e of s){const t=new Date(e.dateObj);t.setMinutes(0,0,0),a.set(t.getTime(),{time:new Date(t),uptime:e.uptimePercentage,status:e.status})}return Array.from(a.values()).sort((e,t)=>e.time.getTime()-t.time.getTime())})(),r=t.width,l=t.height,d=40,c=r-80,o=l-80;s.clearRect(0,0,r,l);const m="#9ca3af";s.fillStyle="#1a1a1a",s.fillRect(0,0,r,l),s.strokeStyle="#333333",s.lineWidth=1;for(let e=0;e<=4;e++){const t=d+o*e/4;s.beginPath(),s.moveTo(d,t),s.lineTo(r-d,t),s.stroke()}for(let e=0;e<=6;e++){const t=d+c*e/6;s.beginPath(),s.moveTo(t,d),s.lineTo(t,l-d),s.stroke()}if(!a.length)return s.fillStyle=m,s.font="13px Inter, sans-serif",s.textAlign="center",s.textBaseline="middle",void s.fillText(n.noHistoryAvailable,r/2,l/2);s.lineWidth=3,s.lineCap="round",s.lineJoin="round";const x=s.createLinearGradient(0,d,0,l-d);x.addColorStop(0,"#10b981"),x.addColorStop(.7,"#f59e0b"),x.addColorStop(1,"#ef4444"),s.strokeStyle=x,s.beginPath(),a.forEach((e,t)=>{const i=d+c*t/(a.length-1),r=l-d-o*e.uptime/100;0===t?s.moveTo(i,r):s.lineTo(i,r)}),s.stroke(),a.forEach((e,t)=>{const i=d+c*t/(a.length-1),r=l-d-o*e.uptime/100;let n="#10b981";"degraded"===e.status&&(n="#f59e0b"),"down"===e.status&&(n="#ef4444"),s.fillStyle=n,s.beginPath(),s.arc(i,r,4,0,2*Math.PI),s.fill(),s.strokeStyle="#ffffff",s.lineWidth=1,s.stroke()}),s.fillStyle=m,s.font="12px Inter, sans-serif",s.textAlign="right",s.textBaseline="middle";for(let e=0;e<=4;e++){const t=d+o*e/4,a=100-25*e;s.fillText(a+"%",30,t)}s.textAlign="center",s.textBaseline="top";for(let e=0;e<=6;e++){const t=d+c*e/6,i=Math.floor((a.length-1)*e/6),r=a[i].time.getHours().toString().padStart(2,"0")+":00";s.fillText(r,t,l-d+10)}s.fillStyle=m,s.font="bold 14px Inter, sans-serif",s.textAlign="left",s.textBaseline="top",s.fillText(n.uptimeHistory+" (24h)",d,10)};return s.useEffect(()=>{const e=i.current;if(!e)return;const t=e.getBoundingClientRect();e.width=t.width*window.devicePixelRatio,e.height=t.height*window.devicePixelRatio;const s=e.getContext("2d");s&&s.scale(window.devicePixelRatio,window.devicePixelRatio),l()},[e,n]),t.jsx("div",{className:`relative ${a}`,children:t.jsx("canvas",{ref:i,className:"w-full h-64 rounded-lg bg-gray-900 border border-gray-700",style:{width:"100%",height:"256px"}})})},R=()=>{const[e,n]=i("/services/:slug"),[l,d]=s.useState(!1),[j,b]=s.useState(""),{data:y=[],isLoading:v}=a({queryKey:["/api/categories"]}),{data:N=null,isLoading:w}=a({queryKey:["/api/status-summary"]}),{data:T,isLoading:k,error:S}=a({queryKey:[`/api/services/${n?.slug}`],enabled:!!n?.slug,refetchInterval:864e5,refetchOnWindowFocus:!1}),{data:$=[],isLoading:R}=a({queryKey:["/api/services"]}),{data:H=[],isLoading:M}=a({queryKey:[`/api/services/${T?.id}/history`],enabled:!!T?.id,refetchInterval:864e5,refetchOnWindowFocus:!1}),{data:D=[],isLoading:O}=a({queryKey:[`/api/services/${T?.id}/incidents`],enabled:!!T?.id}),A=()=>{d(!l)},{t:I,language:L}=r(),q=(e,t)=>{const s=p(new Date(e),"MMM d, yyyy - HH:mm",{locale:f[L]});return t?`${s} ${I.to||"to"} ${p(new Date(t),"HH:mm",{locale:f[L]})}`:`${s} ${I.toPresent||"to present"}`};if(v||w||k||M||O||R)return t.jsx("div",{className:"min-h-screen bg-dark flex items-center justify-center",children:t.jsx("div",{className:"text-white text-xl",children:I.loadingServices})});if(S||!T)return t.jsx("div",{className:"min-h-screen bg-dark flex items-center justify-center",children:t.jsx("div",{className:"text-white text-xl",children:"Service not found"})});const B=T.lastChecked?c(T.lastChecked,L):I.unknown||"Unknown";return t.jsxs("div",{className:"bg-dark text-gray-100 font-sans min-h-screen",children:[t.jsx(o,{onMenuToggle:A,onSearch:e=>{b(e)},services:$}),t.jsxs("div",{className:"flex min-h-[calc(100vh-64px)]",children:[t.jsx(m,{categories:y,statusSummary:N}),t.jsx(x,{isOpen:l,onClose:A,categories:y,statusSummary:N}),t.jsx("main",{className:"flex-1 lg:ml-64 pb-12",children:t.jsx("div",{className:"container mx-auto px-4 py-6",children:t.jsxs("div",{className:"mb-6",children:[t.jsxs("a",{href:"/",className:"text-primary hover:text-blue-400 mb-4 inline-flex items-center",children:[t.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"bg-dark-light p-6 rounded-lg border border-dark-lighter mt-4",children:[t.jsxs("div",{className:"flex items-center mb-6",children:[t.jsx("div",{className:"w-16 h-16 bg-dark-lighter rounded-full flex items-center justify-center mr-6",children:t.jsx("i",{className:`${T.logo||g(T.name)} text-3xl`})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:T.name}),t.jsxs("div",{className:"flex items-center mt-2",children:[t.jsx(h,{status:T.status,className:"mr-3"}),t.jsxs("span",{className:"text-sm text-gray-400",children:[I.lastCheck,": ",B]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:I.currentStatus||"Current Status"}),t.jsx("div",{className:"bg-dark-lighter rounded-lg p-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-400 mb-1",children:I.responseTime||"Response Time"}),t.jsx("p",{className:"font-mono text-lg",children:"down"===T.status?"Timeout":`${T.responseTime}ms`})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-400 mb-1",children:I.uptime30d||"Uptime (30 days)"}),t.jsxs("p",{className:"font-mono text-lg",children:[T.uptimePercentage,"%"]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-400 mb-1",children:I.lastOutage||"Last Outage"}),t.jsx("p",{className:"font-mono text-lg",children:D.length>0?c(D[0].startTime,L):I.noRecentOutages||"No recent outages"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-400 mb-1",children:I.avgResponse||"Avg. Response"}),t.jsx("p",{className:"font-mono text-lg",children:"down"===T.status?"N/A":`${Math.round(H.reduce((e,t)=>e+t.responseTime,0)/(H.length||1))}ms`})]})]})})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:I.uptimeHistory||"Uptime History"}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-dark-lighter rounded-lg p-4",children:t.jsx(C,{history:H})}),t.jsxs("div",{className:"bg-dark-lighter rounded-lg p-4",children:[t.jsx("h3",{className:"text-sm font-medium mb-3 text-gray-400",children:"Cronologia Dettagliata"}),H.length>0?t.jsx(P,{history:H}):t.jsx("p",{className:"text-sm text-gray-400",children:I.noHistoryAvailable||"No history available"})]})]})]})]}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4",children:I.recentIncidents||"Recent Incidents"}),t.jsx("div",{className:"bg-dark-lighter rounded-lg p-4",children:D.length>0?t.jsx("div",{className:"space-y-4",children:D.map(e=>t.jsx("div",{className:"pb-4 border-b border-gray-700 last:border-0 last:pb-0",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 rounded-full bg-${"down"===e.status?"danger":"warning"} bg-opacity-20 text-${"down"===e.status?"danger":"warning"} mt-0.5 mr-3`,children:t.jsx("i",{className:`fas fa-${"down"===e.status?"exclamation-circle":"exclamation-triangle"} text-sm`})}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium mb-1",children:e.title}),t.jsx("p",{className:"text-sm text-gray-400 mb-2",children:e.description}),t.jsx("div",{className:"text-xs text-gray-500 font-mono",children:q(e.startTime,e.endTime)})]})]})},e.id))}):t.jsx("p",{className:"text-sm text-gray-400",children:I.noIncidentsReported||"No incidents reported"})})]})]})]})})})]}),t.jsx(u,{})]})};export{R as default};
//# sourceMappingURL=service-detail-BZfSmWYc.js.map
