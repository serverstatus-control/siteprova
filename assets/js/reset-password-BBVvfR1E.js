import{r as s,aS as e,j as r}from"./react-vendor-BC-NryIe.js";import{u as a}from"./router-MOUxwqPK.js";import{z as o,t}from"./forms-Cf6uUqBP.js";import{C as i,x as n,y as d,z as c,A as l,E as m,B as p}from"./index-CRa19pyD.js";import{I as x}from"./input-BNWx-9ZS.js";import"./vendor-BQl0nyRy.js";import"./radix-ui-ByoYm48K.js";const w=o.object({token:o.string().min(1),password:o.string().min(6,"La password deve essere almeno 6 caratteri"),confirmPassword:o.string().min(1)}).refine(s=>s.password===s.confirmPassword,{message:"Le password non corrispondono",path:["confirmPassword"]});function j(){const[o]=a(),j=new URLSearchParams(o.split("?")[1]||"").get("token")||"",[f,h]=s.useState(null),[u,g]=s.useState(!1),v=e({resolver:t(w),defaultValues:{token:j,password:"",confirmPassword:""}});s.useEffect(()=>{j&&v.setValue("token",j)},[j]);return r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:r.jsx("div",{className:"w-full max-w-md",children:r.jsxs(i,{children:[r.jsxs(n,{children:[r.jsx(d,{children:"Reset Password"}),r.jsx(c,{children:"Inserisci la nuova password"})]}),r.jsxs("form",{onSubmit:v.handleSubmit(async s=>{g(!0),h(null);try{const e=await fetch("/api/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({token:s.token,password:s.password})}),r=await e.json().catch(()=>({}));e.ok?(h("Password aggiornata con successo. Verrai reindirizzato alla schermata di login."),setTimeout(()=>window.location.href="/siteprova/auth",2e3)):h(r?.message||"Errore durante il reset della password")}catch(e){h("Errore di rete")}finally{g(!1)}}),children:[r.jsxs(l,{className:"space-y-4",children:[r.jsx(x,{type:"hidden",...v.register("token")}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 text-sm",children:"Nuova password"}),r.jsx(x,{type:"password",...v.register("password")}),r.jsx("div",{className:"text-sm text-red-400",children:v.formState.errors.password?.message})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block mb-1 text-sm",children:"Conferma password"}),r.jsx(x,{type:"password",...v.register("confirmPassword")}),r.jsx("div",{className:"text-sm text-red-400",children:v.formState.errors.confirmPassword?.message})]}),f&&r.jsx("div",{className:"text-sm text-gray-300",children:f})]}),r.jsx(m,{children:r.jsx(p,{type:"submit",className:"w-full",disabled:u,children:u?"Invio...":"Aggiorna Password"})})]})]})})})}export{j as default};
